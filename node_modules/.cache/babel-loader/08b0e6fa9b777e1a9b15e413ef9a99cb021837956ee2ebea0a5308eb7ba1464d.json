{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport useAuthenticationState from \"@/hook/auth/useAuthenticationState\";\nimport axios from \"axios\";\nimport { defineStore } from \"pinia\";\nconst BASE_URL = 'http://localhost:5170/';\nconst useCart = defineStore(\"Cart\", {\n  state: () => ({\n    Cart: [],\n    CartProduct: [],\n    jwtPayload: \"\"\n  }),\n  getters: {\n    GetCartItemCount(state) {\n      return state.Cart.reduce(total => total + 1, 0);\n    }\n  },\n  actions: {\n    async AddToCart(cartItem) {\n      const state = useAuthenticationState().state;\n      if (state === true) {\n        axios.post(BASE_URL + 'api/Cart/AddCartItems', {\n          id: \"30961341-E2FC-4107-B5F6-169D156F53ED\",\n          productId: cartItem.productId,\n          ProductTypeId: cartItem.productTypeId,\n          quantity: cartItem.quantity\n        });\n        await this.getCartsInDb();\n      } else {\n        const localCart = localStorage.getItem(\"cart\");\n        this.Cart = localCart ? JSON.parse(localCart) : [];\n        const sameItem = this.Cart.find(item => item.productId === cartItem.productId && item.productTypeId === cartItem.productTypeId);\n        if (sameItem === undefined) {\n          this.Cart.push(cartItem);\n        } else {\n          sameItem.quantity += cartItem.quantity;\n        }\n        localStorage.setItem(\"cart\", JSON.stringify(this.Cart));\n      }\n    },\n    async updateQuantity(product) {\n      const state = useAuthenticationState().state;\n      if (state === true) {\n        await axios.put(BASE_URL + 'api/Cart/UpdateQuantity', {\n          id: \"30961341-E2FC-4107-B5F6-169D156F53ED\",\n          productId: product.ProductId,\n          ProductTypeId: product.ProductTypeId,\n          quantity: product.Quantity\n        });\n      } else {\n        const localCart = localStorage.getItem(\"cart\");\n        this.Cart = localCart ? JSON.parse(localCart) : [];\n        const sameItem = this.Cart.find(item => item.productId === product.ProductId && item.productTypeId == product.ProductTypeId);\n        if (sameItem === undefined) {\n          return;\n        }\n        sameItem.Quantity = product.Quantity;\n        localStorage.setItem(\"cart\", JSON.stringify(this.Cart));\n      }\n    },\n    async RemoveProduct(product, index) {\n      const state = useAuthenticationState().state;\n      if (state === true) {\n        this.Cart.splice(index, 1);\n        await axios.delete(BASE_URL + 'api/Cart/RemoveCartItem/' + product.ProductId + '/' + product.ProductTypeId);\n      } else {\n        this.Cart.splice(index, 1);\n        localStorage.setItem(\"cart\", JSON.stringify(this.Cart));\n      }\n    },\n    async storeCartItems(jwtPayload) {\n      const state = useAuthenticationState().state;\n      if (state === true) {\n        const localCart = localStorage.getItem(\"cart\");\n        this.Cart = localCart ? JSON.parse(localCart) : [];\n        this.jwtPayload = jwtPayload;\n        axios.interceptors.request.use(config => {\n          config.headers.Authorization = `Bearer ${jwtPayload}`;\n          return config;\n        });\n        if (this.Cart.length > 0) {\n          await axios.post(BASE_URL + 'api/Cart/StoreCartItems', this.Cart);\n          localStorage.removeItem(\"cart\");\n        }\n      }\n    },\n    async GetCartsInDb() {\n      await axios.get(BASE_URL + 'api/Cart/GetCartProductsInDb').then(res => {\n        if (this.jwtPayload !== \"\" && this.jwtPayload !== undefined) {\n          axios.interceptors.request.use(config => {\n            config.headers.Authorization = `Bearer ${this.jwtPayload}`;\n            return config;\n          });\n        }\n        this.Cart = res.data.data;\n      });\n    }\n  }\n});\nexport default useCart;","map":{"version":3,"names":["useAuthenticationState","axios","defineStore","BASE_URL","useCart","state","Cart","CartProduct","jwtPayload","getters","GetCartItemCount","reduce","total","actions","AddToCart","cartItem","post","id","productId","ProductTypeId","productTypeId","quantity","getCartsInDb","localCart","localStorage","getItem","JSON","parse","sameItem","find","item","undefined","push","setItem","stringify","updateQuantity","product","put","ProductId","Quantity","RemoveProduct","index","splice","delete","storeCartItems","interceptors","request","use","config","headers","Authorization","length","removeItem","GetCartsInDb","get","then","res","data"],"sources":["D:/PersonalFile/WebStudy/myShop-vue/myshop-vue/src/stores/useCart.js"],"sourcesContent":["import useAuthenticationState from \"@/hook/auth/useAuthenticationState\";\r\nimport axios from \"axios\";\r\nimport { defineStore } from \"pinia\";\r\n\r\nconst BASE_URL = 'http://localhost:5170/'\r\n\r\nconst useCart = defineStore(\"Cart\", {\r\n    state: () => ({\r\n        Cart: [],\r\n        CartProduct: [],\r\n        jwtPayload: \"\"\r\n    }),\r\n    getters: {\r\n        GetCartItemCount(state) {\r\n            return state.Cart.reduce((total) => total + 1, 0)\r\n        }\r\n    },\r\n    actions: {\r\n        async AddToCart(cartItem) {\r\n\r\n            const state = useAuthenticationState().state;\r\n\r\n            if (state === true) {\r\n\r\n                axios.post(BASE_URL + 'api/Cart/AddCartItems', {\r\n                    id: \"30961341-E2FC-4107-B5F6-169D156F53ED\",\r\n                    productId: cartItem.productId,\r\n                    ProductTypeId: cartItem.productTypeId,\r\n                    quantity: cartItem.quantity\r\n                })\r\n\r\n                await this.getCartsInDb();\r\n\r\n            } else {\r\n\r\n                const localCart = localStorage.getItem(\"cart\");\r\n                this.Cart = localCart ? JSON.parse(localCart) : [];\r\n                const sameItem = this.Cart.find(item => item.productId === cartItem.productId && item.productTypeId === cartItem.productTypeId);\r\n                if (sameItem === undefined) {\r\n                    this.Cart.push(cartItem);\r\n                } else {\r\n                    sameItem.quantity += cartItem.quantity;\r\n                }\r\n                localStorage.setItem(\"cart\", JSON.stringify(this.Cart));\r\n            }\r\n        },\r\n        async updateQuantity(product) {\r\n            const state = useAuthenticationState().state;\r\n            if (state === true) {\r\n\r\n                await axios.put(BASE_URL + 'api/Cart/UpdateQuantity', {\r\n                    id: \"30961341-E2FC-4107-B5F6-169D156F53ED\",\r\n                    productId: product.ProductId,\r\n                    ProductTypeId: product.ProductTypeId,\r\n                    quantity: product.Quantity\r\n                })\r\n            } else {\r\n\r\n                const localCart = localStorage.getItem(\"cart\");\r\n                this.Cart = localCart ? JSON.parse(localCart) : [];\r\n                const sameItem = this.Cart.find(item => item.productId === product.ProductId && item.productTypeId == product.ProductTypeId);\r\n\r\n                if (sameItem === undefined) {\r\n                    return;\r\n                }\r\n\r\n                sameItem.Quantity = product.Quantity;\r\n                localStorage.setItem(\"cart\", JSON.stringify(this.Cart))\r\n            }\r\n        },\r\n        async RemoveProduct(product, index) {\r\n            const state = useAuthenticationState().state;\r\n\r\n            if (state === true) {\r\n                this.Cart.splice(index, 1);\r\n                await axios.delete(BASE_URL + 'api/Cart/RemoveCartItem/' + product.ProductId + '/' + product.ProductTypeId)\r\n            } else {\r\n                this.Cart.splice(index, 1);\r\n                localStorage.setItem(\"cart\", JSON.stringify(this.Cart));\r\n            }\r\n        },\r\n        async storeCartItems(jwtPayload) {\r\n            const state = useAuthenticationState().state;\r\n\r\n            if (state === true) {\r\n                const localCart = localStorage.getItem(\"cart\");\r\n                this.Cart = localCart ? JSON.parse(localCart) : [];\r\n\r\n                this.jwtPayload = jwtPayload;\r\n\r\n                axios.interceptors.request.use(config => {\r\n                    config.headers.Authorization = `Bearer ${jwtPayload}`;\r\n                    return config;\r\n                })\r\n\r\n                if (this.Cart.length > 0) {\r\n                    await axios.post(BASE_URL + 'api/Cart/StoreCartItems', this.Cart);\r\n                    localStorage.removeItem(\"cart\")\r\n                }\r\n            }\r\n        },\r\n        async GetCartsInDb() {\r\n            await axios.get(BASE_URL + 'api/Cart/GetCartProductsInDb').then(res => {\r\n                if (this.jwtPayload !== \"\" && this.jwtPayload !== undefined) {\r\n                    axios.interceptors.request.use(config => {\r\n                        config.headers.Authorization = `Bearer ${this.jwtPayload}`;\r\n                        return config;\r\n                    })\r\n                }\r\n\r\n                this.Cart = res.data.data\r\n            })\r\n        }\r\n\r\n    }\r\n})\r\n\r\nexport default useCart"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}