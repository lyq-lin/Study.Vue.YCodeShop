{"ast":null,"code":"import useProductList from \"@/stores/useProductList\";\nimport { onMounted, reactive, ref } from \"vue\";\nimport { useRoute } from \"vue-router\";\nimport { ShoppingCart } from '@element-plus/icons-vue';\nexport default {\n  __name: 'ProductDetail',\n  setup(__props, {\n    expose: __expose\n  }) {\n    __expose();\n    const currentTypeId = ref(\"e84893a3-cad7-4ef3-8f7d-58e090c7f128\"); //默认当前类型的套餐\n\n    const ProductList = useProductList();\n    const route = useRoute();\n    const product = ref({});\n    const productTypes = ref([]);\n    onMounted(async () => {\n      if (ProductList.Products.length === 0) {\n        await ProductList.getAllProduct();\n      }\n      await ProductList.getProductTypeByProductId(route.params.id);\n      product.value = ProductList.GetProdcutById(route.params.id);\n      productTypes.value = ProductList.ProductTypes;\n      console.log(product.value);\n      if (product.value.variants.length > 0) {\n        var prices = product.value.variants.map(variant => variant.price);\n        var minPrice = Math.min(...prices);\n        currentTypeId.value = product.value.variants.find(x => x.price === minPrice).productTypeId;\n      }\n    });\n    function GetSelectedProdcutVariant() {\n      if (product.value.variants != undefined) {\n        var variant = product.value.variants.find(v => v.productTypeId == currentTypeId.value);\n        return variant;\n      }\n    }\n    async function AddToCart() {\n      var variant = GetSelectedProdcutVariant();\n      var cartItem = reactive({\n        ProductId: variant.productId,\n        ProductTypeId: variant.productTypeId,\n        Quantity: 1\n      });\n      await cartItem.AddToCart(cartItem);\n    }\n    const __returned__ = {\n      currentTypeId,\n      ProductList,\n      route,\n      product,\n      productTypes,\n      GetSelectedProdcutVariant,\n      AddToCart,\n      get useProductList() {\n        return useProductList;\n      },\n      onMounted,\n      reactive,\n      ref,\n      get useRoute() {\n        return useRoute;\n      },\n      get ShoppingCart() {\n        return ShoppingCart;\n      }\n    };\n    Object.defineProperty(__returned__, '__isScriptSetup', {\n      enumerable: false,\n      value: true\n    });\n    return __returned__;\n  }\n};","map":{"version":3,"names":["useProductList","onMounted","reactive","ref","useRoute","ShoppingCart","currentTypeId","ProductList","route","product","productTypes","Products","length","getAllProduct","getProductTypeByProductId","params","id","value","GetProdcutById","ProductTypes","console","log","variants","prices","map","variant","price","minPrice","Math","min","find","x","productTypeId","GetSelectedProdcutVariant","undefined","v","AddToCart","cartItem","ProductId","productId","ProductTypeId","Quantity"],"sources":["D:/PersonalFile/WebStudy/myShop-vue/myshop-vue/src/pages/ProductDetail/ProductDetail.vue"],"sourcesContent":["<template>\r\n    <div class=\"media\" v-show=\"product != null\">\r\n        <div class=\"media-img-wrapper\">\r\n            <img class=\"media-img\" :src=\"product.imageUrl\" :alt=\"product.title\" />\r\n        </div>\r\n\r\n        <div class=\"media-body\">\r\n            <h2>{{ product.title }}</h2>\r\n            <p>{{ product.description }}</p>\r\n\r\n            <template v-if=\"product.variants != null && product.variants.length > 1\">\r\n                <el-radio-group v-model=\"currentTypeId\" class=\"ml-4\">\r\n                    <el-radio v-for=\"productType in productTypes\" :key=\"productType.id\" :label=\"productType.id\">\r\n                        {{ productType.name }}\r\n                    </el-radio>\r\n                </el-radio-group>\r\n            </template>\r\n\r\n            <template v-if=\"GetSelectedProdcutVariant() != null\">\r\n                <template v-if=\"GetSelectedProdcutVariant().originalPrice > GetSelectedProdcutVariant().price\">\r\n                    <h6 class=\"text-muted original-price\">\r\n                        原价：￥{{ GetSelectedProdcutVariant().originalPrice }}\r\n                    </h6>\r\n                </template>\r\n\r\n                <h4 class=\"price\">\r\n                    到手价：￥{{ GetSelectedProdcutVariant().price }}\r\n                </h4>\r\n            </template>\r\n\r\n            <el-button color=\"#626aef\" :icon=\"ShoppingCart\" @click=\"AddToCart\">加入购物车</el-button>\r\n        </div>\r\n    </div>\r\n</template>\r\n\r\n<script setup>\r\nimport useProductList from \"@/stores/useProductList\";\r\nimport { onMounted, reactive, ref } from \"vue\";\r\nimport { useRoute } from \"vue-router\";\r\nimport { ShoppingCart } from '@element-plus/icons-vue'\r\n\r\nconst currentTypeId = ref(\"e84893a3-cad7-4ef3-8f7d-58e090c7f128\");  //默认当前类型的套餐\r\n\r\nconst ProductList = useProductList();\r\nconst route = useRoute();\r\nconst product = ref({})\r\nconst productTypes = ref([])\r\n\r\nonMounted(async () => {\r\n    if (ProductList.Products.length === 0) {\r\n        await ProductList.getAllProduct();\r\n    }\r\n    await ProductList.getProductTypeByProductId(route.params.id);\r\n\r\n    product.value = ProductList.GetProdcutById(route.params.id);\r\n    productTypes.value = ProductList.ProductTypes\r\n\r\n    console.log(product.value)\r\n\r\n    if (product.value.variants.length > 0) {\r\n        var prices = product.value.variants.map(variant => variant.price);\r\n        var minPrice = Math.min(...prices);\r\n\r\n        currentTypeId.value = product.value.variants.find(x => x.price === minPrice).productTypeId;\r\n    }\r\n});\r\n\r\nfunction GetSelectedProdcutVariant() {\r\n    if (product.value.variants != undefined) {\r\n        var variant = product.value.variants.find(v => v.productTypeId == currentTypeId.value)\r\n        return variant;\r\n    }\r\n}\r\n\r\nasync function AddToCart() {\r\n    var variant = GetSelectedProdcutVariant();\r\n    var cartItem = reactive({\r\n        ProductId: variant.productId,\r\n        ProductTypeId: variant.productTypeId,\r\n        Quantity: 1\r\n    })\r\n\r\n    await cartItem.AddToCart(cartItem);\r\n}\r\n\r\n</script>\r\n\r\n<style scoped>\r\n.media {\r\n    display: flex;\r\n}\r\n\r\n.media-img {\r\n    max-height: 500px;\r\n    max-width: 500px;\r\n    border-radius: 6px;\r\n    margin: 0 10px 10px 10px;\r\n}\r\n\r\n.media-img-wrapper {\r\n    max-width: 500px;\r\n    max-height: 500px;\r\n    text-align: center;\r\n    flex: 1;\r\n}\r\n\r\n.media-body {\r\n    flex: 1;\r\n}\r\n\r\n.original-price {\r\n    text-decoration: line-through;\r\n}\r\n\r\n.price {\r\n    color: green;\r\n}\r\n</style>"],"mappings":"AAoCA,OAAOA,cAAc,MAAM,yBAAyB;AACpD,SAASC,SAAS,EAAEC,QAAQ,EAAEC,GAAG,QAAQ,KAAK;AAC9C,SAASC,QAAQ,QAAQ,YAAY;AACrC,SAASC,YAAY,QAAQ,yBAAyB;;;;;;;IAEtD,MAAMC,aAAa,GAAGH,GAAG,CAAC,sCAAsC,CAAC,CAAC,CAAE;;IAEpE,MAAMI,WAAW,GAAGP,cAAc,CAAC,CAAC;IACpC,MAAMQ,KAAK,GAAGJ,QAAQ,CAAC,CAAC;IACxB,MAAMK,OAAO,GAAGN,GAAG,CAAC,CAAC,CAAC,CAAC;IACvB,MAAMO,YAAY,GAAGP,GAAG,CAAC,EAAE,CAAC;IAE5BF,SAAS,CAAC,YAAY;MAClB,IAAIM,WAAW,CAACI,QAAQ,CAACC,MAAM,KAAK,CAAC,EAAE;QACnC,MAAML,WAAW,CAACM,aAAa,CAAC,CAAC;MACrC;MACA,MAAMN,WAAW,CAACO,yBAAyB,CAACN,KAAK,CAACO,MAAM,CAACC,EAAE,CAAC;MAE5DP,OAAO,CAACQ,KAAK,GAAGV,WAAW,CAACW,cAAc,CAACV,KAAK,CAACO,MAAM,CAACC,EAAE,CAAC;MAC3DN,YAAY,CAACO,KAAK,GAAGV,WAAW,CAACY,YAAY;MAE7CC,OAAO,CAACC,GAAG,CAACZ,OAAO,CAACQ,KAAK,CAAC;MAE1B,IAAIR,OAAO,CAACQ,KAAK,CAACK,QAAQ,CAACV,MAAM,GAAG,CAAC,EAAE;QACnC,IAAIW,MAAM,GAAGd,OAAO,CAACQ,KAAK,CAACK,QAAQ,CAACE,GAAG,CAACC,OAAO,IAAIA,OAAO,CAACC,KAAK,CAAC;QACjE,IAAIC,QAAQ,GAAGC,IAAI,CAACC,GAAG,CAAC,GAAGN,MAAM,CAAC;QAElCjB,aAAa,CAACW,KAAK,GAAGR,OAAO,CAACQ,KAAK,CAACK,QAAQ,CAACQ,IAAI,CAACC,CAAC,IAAIA,CAAC,CAACL,KAAK,KAAKC,QAAQ,CAAC,CAACK,aAAa;MAC9F;IACJ,CAAC,CAAC;IAEF,SAASC,yBAAyBA,CAAA,EAAG;MACjC,IAAIxB,OAAO,CAACQ,KAAK,CAACK,QAAQ,IAAIY,SAAS,EAAE;QACrC,IAAIT,OAAO,GAAGhB,OAAO,CAACQ,KAAK,CAACK,QAAQ,CAACQ,IAAI,CAACK,CAAC,IAAIA,CAAC,CAACH,aAAa,IAAI1B,aAAa,CAACW,KAAK,CAAC;QACtF,OAAOQ,OAAO;MAClB;IACJ;IAEA,eAAeW,SAASA,CAAA,EAAG;MACvB,IAAIX,OAAO,GAAGQ,yBAAyB,CAAC,CAAC;MACzC,IAAII,QAAQ,GAAGnC,QAAQ,CAAC;QACpBoC,SAAS,EAAEb,OAAO,CAACc,SAAS;QAC5BC,aAAa,EAAEf,OAAO,CAACO,aAAa;QACpCS,QAAQ,EAAE;MACd,CAAC,CAAC;MAEF,MAAMJ,QAAQ,CAACD,SAAS,CAACC,QAAQ,CAAC;IACtC"},"metadata":{},"sourceType":"module","externalDependencies":[]}