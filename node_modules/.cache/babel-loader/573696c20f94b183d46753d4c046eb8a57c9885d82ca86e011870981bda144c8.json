{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport { unref as _unref, createVNode as _createVNode, resolveComponent as _resolveComponent, withCtx as _withCtx, createTextVNode as _createTextVNode, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, createCommentVNode as _createCommentVNode, createBlock as _createBlock } from \"vue\";\nimport { ArrowDown, UserFilled } from \"@element-plus/icons-vue\";\nimport useAuthenticationState from '@/hook/auth/useAuthenticationState';\nimport { useRouter } from \"vue-router\";\nimport useUser from '@/stores/useUser';\nimport { onMounted, reactive, ref } from \"vue\";\nimport useCart from \"@/stores/useCart\";\nexport default {\n  __name: 'UserButton',\n  setup(__props) {\n    const isAuth = ref(useAuthenticationState());\n    const router = useRouter();\n    const User = useUser();\n    const userObj = reactive(User.user);\n    const Cart = useCart();\n    onMounted(() => {\n      setInterval(() => {\n        isAuth.value.state = ref(useAuthenticationState()).value.state;\n      }, 700);\n    });\n    function ToLogin() {\n      router.push({\n        path: '/login'\n      });\n    }\n    function ToRegister() {\n      router.push({\n        path: '/register'\n      });\n    }\n    async function Logout() {\n      await User.logout();\n      Cart.Cart = [];\n      Cart.CartProduct = [];\n      router.push({\n        path: '/login'\n      });\n    }\n    function ToProfile() {\n      router.push({\n        path: '/profile'\n      });\n    }\n    function ToOrder() {\n      router.push({\n        path: '/order'\n      });\n    }\n    return (_ctx, _cache) => {\n      const _component_el_icon = _resolveComponent(\"el-icon\");\n      const _component_el_button = _resolveComponent(\"el-button\");\n      const _component_el_dropdown_item = _resolveComponent(\"el-dropdown-item\");\n      const _component_el_dropdown_menu = _resolveComponent(\"el-dropdown-menu\");\n      const _component_el_dropdown = _resolveComponent(\"el-dropdown\");\n      return _openBlock(), _createBlock(_component_el_dropdown, null, {\n        dropdown: _withCtx(() => [_createVNode(_component_el_dropdown_menu, null, {\n          default: _withCtx(() => [isAuth.value.state === false ? (_openBlock(), _createElementBlock(_Fragment, {\n            key: 0\n          }, [_createVNode(_component_el_dropdown_item, {\n            onClick: ToLogin\n          }, {\n            default: _withCtx(() => [_createTextVNode(\"登录\")]),\n            _: 1\n          }), _createVNode(_component_el_dropdown_item, {\n            onClick: ToRegister\n          }, {\n            default: _withCtx(() => [_createTextVNode(\"注册\")]),\n            _: 1\n          })], 64)) : _createCommentVNode(\"\", true), isAuth.value.state === true ? (_openBlock(), _createElementBlock(_Fragment, {\n            key: 1\n          }, [_createVNode(_component_el_dropdown_item, {\n            onClick: ToProfile\n          }, {\n            default: _withCtx(() => [_createTextVNode(\"用户中心\")]),\n            _: 1\n          }), _createVNode(_component_el_dropdown_item, {\n            onClick: ToOrder\n          }, {\n            default: _withCtx(() => [_createTextVNode(\"订单\")]),\n            _: 1\n          }), userObj.userRole === 'Admin' ? (_openBlock(), _createBlock(_component_el_dropdown_item, {\n            key: 0\n          }, {\n            default: _withCtx(() => [_createTextVNode(\"管理面板\")]),\n            _: 1\n          })) : _createCommentVNode(\"\", true), _createVNode(_component_el_dropdown_item, {\n            onClick: Logout\n          }, {\n            default: _withCtx(() => [_createTextVNode(\"退出账号\")]),\n            _: 1\n          })], 64)) : _createCommentVNode(\"\", true)]),\n          _: 1\n        })]),\n        default: _withCtx(() => [_createVNode(_component_el_button, {\n          type: \"primary\",\n          size: \"large\",\n          class: \"media-user\"\n        }, {\n          default: _withCtx(() => [_createVNode(_component_el_icon, null, {\n            default: _withCtx(() => [_createVNode(_unref(UserFilled))]),\n            _: 1\n          }), _createVNode(_component_el_icon, {\n            class: \"el-icon--right\",\n            size: \"large\"\n          }, {\n            default: _withCtx(() => [_createVNode(_unref(ArrowDown))]),\n            _: 1\n          })]),\n          _: 1\n        })]),\n        _: 1\n      });\n    };\n  }\n};","map":{"version":3,"names":["ArrowDown","UserFilled","useAuthenticationState","useRouter","useUser","onMounted","reactive","ref","useCart","isAuth","router","User","userObj","user","Cart","setInterval","value","state","ToLogin","push","path","ToRegister","Logout","logout","CartProduct","ToProfile","ToOrder"],"sources":["D:/PersonalFile/WebStudy/myShop-vue/myshop-vue/src/components/UserButton.vue"],"sourcesContent":["<template>\r\n    <el-dropdown>\r\n        <el-button type=\"primary\" size=\"large\" class=\"media-user\">\r\n            <el-icon>\r\n                <UserFilled />\r\n            </el-icon>\r\n            <el-icon class=\"el-icon--right\" size=\"large\">\r\n                <ArrowDown />\r\n            </el-icon>\r\n        </el-button>\r\n\r\n        <template #dropdown>\r\n            <el-dropdown-menu>\r\n                <template v-if=\"isAuth.state === false\">\r\n                    <el-dropdown-item @click=\"ToLogin\">登录</el-dropdown-item>\r\n                    <el-dropdown-item @click=\"ToRegister\">注册</el-dropdown-item>\r\n                </template>\r\n\r\n                <template v-if=\"isAuth.state === true\">\r\n                    <el-dropdown-item @click=\"ToProfile\">用户中心</el-dropdown-item>\r\n                    <el-dropdown-item @click=\"ToOrder\">订单</el-dropdown-item>\r\n\r\n                    <template v-if=\"userObj.userRole === 'Admin'\">\r\n                        <el-dropdown-item>管理面板</el-dropdown-item>\r\n                    </template>\r\n\r\n                    <el-dropdown-item @click=\"Logout\">退出账号</el-dropdown-item>\r\n                </template>\r\n\r\n            </el-dropdown-menu>\r\n        </template>\r\n    </el-dropdown>\r\n</template>\r\n\r\n<script setup>\r\nimport { ArrowDown, UserFilled } from \"@element-plus/icons-vue\";\r\nimport useAuthenticationState from '@/hook/auth/useAuthenticationState'\r\nimport { useRouter } from \"vue-router\"\r\nimport useUser from '@/stores/useUser'\r\nimport { onMounted, reactive, ref } from \"vue\";\r\nimport useCart from \"@/stores/useCart\";\r\n\r\nconst isAuth = ref(useAuthenticationState())\r\nconst router = useRouter();\r\nconst User = useUser();\r\nconst userObj = reactive(User.user);\r\nconst Cart = useCart();\r\n\r\nonMounted(() => {\r\n    setInterval(() => {\r\n        isAuth.value.state = ref(useAuthenticationState()).value.state\r\n    }, 700)\r\n})\r\n\r\nfunction ToLogin() {\r\n    router.push({\r\n        path: '/login'\r\n    })\r\n}\r\n\r\nfunction ToRegister() {\r\n    router.push({\r\n        path: '/register'\r\n    })\r\n}\r\n\r\nasync function Logout() {\r\n    await User.logout();\r\n    Cart.Cart = [];\r\n    Cart.CartProduct = [];\r\n    router.push({\r\n        path: '/login'\r\n    })\r\n}\r\n\r\nfunction ToProfile() {\r\n    router.push({\r\n        path: '/profile'\r\n    })\r\n}\r\n\r\nfunction ToOrder() {\r\n    router.push({\r\n        path: '/order'\r\n    })\r\n}\r\n\r\n\r\n</script>\r\n\r\n<style scoped>\r\n.media-user {\r\n    margin: 15px;\r\n}\r\n</style>"],"mappings":";;AAmCA,SAASA,SAAS,EAAEC,UAAU,QAAQ,yBAAyB;AAC/D,OAAOC,sBAAsB,MAAM,oCAAoC;AACvE,SAASC,SAAS,QAAQ,YAAY;AACtC,OAAOC,OAAO,MAAM,kBAAkB;AACtC,SAASC,SAAS,EAAEC,QAAQ,EAAEC,GAAG,QAAQ,KAAK;AAC9C,OAAOC,OAAO,MAAM,kBAAkB;;;;IAEtC,MAAMC,MAAM,GAAGF,GAAG,CAACL,sBAAsB,CAAC,CAAC,CAAC;IAC5C,MAAMQ,MAAM,GAAGP,SAAS,CAAC,CAAC;IAC1B,MAAMQ,IAAI,GAAGP,OAAO,CAAC,CAAC;IACtB,MAAMQ,OAAO,GAAGN,QAAQ,CAACK,IAAI,CAACE,IAAI,CAAC;IACnC,MAAMC,IAAI,GAAGN,OAAO,CAAC,CAAC;IAEtBH,SAAS,CAAC,MAAM;MACZU,WAAW,CAAC,MAAM;QACdN,MAAM,CAACO,KAAK,CAACC,KAAK,GAAGV,GAAG,CAACL,sBAAsB,CAAC,CAAC,CAAC,CAACc,KAAK,CAACC,KAAK;MAClE,CAAC,EAAE,GAAG,CAAC;IACX,CAAC,CAAC;IAEF,SAASC,OAAOA,CAAA,EAAG;MACfR,MAAM,CAACS,IAAI,CAAC;QACRC,IAAI,EAAE;MACV,CAAC,CAAC;IACN;IAEA,SAASC,UAAUA,CAAA,EAAG;MAClBX,MAAM,CAACS,IAAI,CAAC;QACRC,IAAI,EAAE;MACV,CAAC,CAAC;IACN;IAEA,eAAeE,MAAMA,CAAA,EAAG;MACpB,MAAMX,IAAI,CAACY,MAAM,CAAC,CAAC;MACnBT,IAAI,CAACA,IAAI,GAAG,EAAE;MACdA,IAAI,CAACU,WAAW,GAAG,EAAE;MACrBd,MAAM,CAACS,IAAI,CAAC;QACRC,IAAI,EAAE;MACV,CAAC,CAAC;IACN;IAEA,SAASK,SAASA,CAAA,EAAG;MACjBf,MAAM,CAACS,IAAI,CAAC;QACRC,IAAI,EAAE;MACV,CAAC,CAAC;IACN;IAEA,SAASM,OAAOA,CAAA,EAAG;MACfhB,MAAM,CAACS,IAAI,CAAC;QACRC,IAAI,EAAE;MACV,CAAC,CAAC;IACN"},"metadata":{},"sourceType":"module","externalDependencies":[]}